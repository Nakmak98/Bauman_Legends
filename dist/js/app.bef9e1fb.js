(function(e){function t(t){for(var a,r,u=t[0],i=t[1],c=t[2],m=0,p=[];m<u.length;m++)r=u[m],Object.prototype.hasOwnProperty.call(n,r)&&n[r]&&p.push(n[r][0]),n[r]=0;for(a in i)Object.prototype.hasOwnProperty.call(i,a)&&(e[a]=i[a]);l&&l(t);while(p.length)p.shift()();return o.push.apply(o,c||[]),s()}function s(){for(var e,t=0;t<o.length;t++){for(var s=o[t],a=!0,u=1;u<s.length;u++){var i=s[u];0!==n[i]&&(a=!1)}a&&(o.splice(t--,1),e=r(r.s=s[0]))}return e}var a={},n={app:0},o=[];function r(t){if(a[t])return a[t].exports;var s=a[t]={i:t,l:!1,exports:{}};return e[t].call(s.exports,s,s.exports,r),s.l=!0,s.exports}r.m=e,r.c=a,r.d=function(e,t,s){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(r.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)r.d(s,a,function(t){return e[t]}.bind(null,a));return s},r.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="/";var u=window["webpackJsonp"]=window["webpackJsonp"]||[],i=u.push.bind(u);u.push=t,u=u.slice();for(var c=0;c<u.length;c++)t(u[c]);var l=i;o.push([0,"chunk-vendors"]),s()})({0:function(e,t,s){e.exports=s("56d7")},3202:function(e,t,s){},"56d7":function(e,t,s){"use strict";s.r(t);s("cadf"),s("551c"),s("f751"),s("097d");var a=s("2b0e"),n=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{attrs:{id:"app"}},[s("base-popup",{attrs:{popup:"popup_options"}}),s("div",{attrs:{id:"nav"}},[s("router-link",{attrs:{to:"/"}},[e._v("Home")]),e._v(" |\n    "),s("router-link",{attrs:{to:"/account"}},[e._v("Account")])],1),s("router-view")],1)},o=[],r={name:"app",data:function(){return{popup_options:{message:"",placeholder:"",input_field:!1,show:!1,callback:function(){}}}},mounted:function(){this.$on("popup",this.pass_options)},methods:{pass_options:function(e){console.log("asdasdas"),this.popup_options=e}}},u=r,i=(s("5c0b"),s("2877")),c=Object(i["a"])(u,n,o,!1,null,null,null),l=c.exports,m=s("8c4f"),p=function(){var e=this,t=e.$createElement;e._self._c;return e._m(0)},d=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"home"},[a("img",{attrs:{alt:"Vue logo",src:s("cf05")}})])}],_={name:"home",data:function(){return{}}},f=_,h=Object(i["a"])(f,p,d,!1,null,null,null),v=h.exports,b=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"auth"},[s("base-button",{attrs:{title:"Войти"},on:{click:function(t){return e.$router.push("/sign_in")}}}),s("base-button",{attrs:{title:"Зарегистрироваться"},on:{click:function(t){return e.$router.push("/sign_up")}}}),s("router-view")],1)},g=[],y={name:"Auth"},$=y,k=Object(i["a"])($,b,g,!1,null,"3e24c131",null),q=k.exports,w=function(){var e=this,t=e.$createElement,s=e._self._c||t;return e.user?s("div",{staticClass:"about",on:{popup:function(e){return this.$emit("popup")}}},[s("h1",[e._v("Личный кабинет")]),s("ul",e._l(e.user,function(t){return s("p",[e._v(e._s(t))])}),0),s("div",[e.user.team_id?e._e():s("without-team-player"),e.user.team_id?s("with-team-player"):e._e(),s("base-button",{attrs:{title:"Удалить аккаунт"},on:{click:e.check_delete_account}}),e.user.team_id?s("base-button",{attrs:{title:"Выйти из команды"},on:{click:e.check_leave_team}}):e._e(),s("base-button",{attrs:{title:"Выйти"},on:{click:e.logout}}),s("base-error-message",{attrs:{message:e.error_message},on:{error:e.show_error}})],1)]):e._e()},x=[],O=s("bc3a"),j=s.n(O),T=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"account-menu-container",attrs:{id:"account-menu"}},[e._v("\n    Вы ещё не состоите в команде."),s("span",{on:{click:function(t){return e.$router.push("/team/create")}}},[e._v("Создайте её")]),e._v("\n    или "),s("span",{on:{click:function(t){return e.$router.push("/join")}}},[e._v("присоединитесь")]),e._v(" к существующей.\n")])},D=[],P={name:"withoutTeamPlayer"},E=P,U=(s("fccb"),Object(i["a"])(E,T,D,!1,null,"512af2ff",null)),M=U.exports,S=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("h2",[e._v("Команда № "+e._s(e.team.team_id))]),s("h2",[e._v(e._s(e.team.team_name))]),s("h2",[e._v(e._s(e.team.invite_code))]),s("table",[s("tr",[s("td",[e._v("Имя")]),s("td",[e._v("Фамилия")]),s("td",[e._v("VK")]),"CAPTAIN"===e.user.role?s("td",[e._v("Удалить участника")]):e._e()]),e._l(e.team_members,function(t){return s("tr",[s("td",[e._v(e._s(t.first_name))]),s("td",[e._v(e._s(t.last_name))]),s("td",[e._v(e._s(t.vk_ref))]),"CAPTAIN"===e.user.role?s("td",{staticClass:"kick-btn",on:{click:function(s){return e.check_delete_action(t)}}},[e._v("X")]):e._e()])})],2),s("base-button",{attrs:{title:"Старт!"}})],1)},C=[],A={name:"WithTeamPlayer",data:function(){return{request_body:{user_id:""},show_popup:!1,popup_message:""}},computed:{team_members:function(){return this.$store.state.team_members},team:function(){return this.$store.state.team},user:function(){return this.$store.state.user}},mounted:function(){this.team_members||this.request_team_members()},methods:{request_team_members:function(){var e=this;j.a.get("/team/members").then(function(t){console.log(t.data),e.$store.commit("setTeamMembers",t.data)}).catch(function(t){t.response&&(console.log(t.response.status),console.log(t.message),401===t.response.status?e.$route.push("/auth"):e.$emit("error",t.message))})},check_delete_action:function(e){this.request_body.user_id=e.user_id;var t={message:"Вы уверены, что хотите удалить "+e.first_name+"?",placeholder:"",input_field:!1,show:!0,callback:this.delete_member,args:this.request_body};this.$store.commit("setPopupOptions",t)},delete_member:function(e){var t=this;j.a.delete("/team/kick",{params:e}).then(function(e){console.log(e.status),console.log(e.data),t.$store.commit("deleteTeamData"),t.$store.dispatch("updateUserData"),t.$store.commit("deleteTeamMembers")}).catch(function(e){console.log(e.response.status),console.log(t.request_body.kick_id),e.response.status})}}},I=A,N=(s("f5c5"),Object(i["a"])(I,S,C,!1,null,null,null)),J=N.exports,V={name:"account",components:{WithoutTeamPlayer:M,WithTeamPlayer:J},data:function(){return{error_message:"",popup_message:""}},computed:{user:function(){return this.$store.state.user},team:function(){return this.$store.state.team},team_members:function(){return this.$store.state.team_members}},mounted:function(){this.user||this.request_user_data(),this.user&&!this.team&&this.request_team_data()},methods:{logout:function(){var e=this;j.a.get("/user/logout").then(function(t){console.log(t.status),e.$store.commit("deleteUserData"),e.$store.commit("deleteTeamData"),e.$store.commit("deleteTeamMembers"),e.$router.push("/auth")})},delete_account:function(){var e=this;j.a.delete("/user/delete").then(function(t){console.log(t.status),console.log(t.data),e.$store.commit("deleteUserData"),e.$store.commit("deleteTeamData"),e.$store.commit("deleteTeamMembers"),e.$router.push("/auth")}).catch(function(t){console.log(t.response.status),401===t.response.status&&(e.error_message=t.message)})},request_user_data:function(){var e=this;j.a.get("/user/info").then(function(t){console.log(t.status),console.log(t.data),e.$store.commit("setUserData",t.data),e.request_team_data()}).catch(function(t){t.response&&(401===t.response.status?e.$router.push("/auth"):e.error_message=t.message)})},request_team_data:function(){var e=this;j.a.get("/team/info").then(function(t){console.log(t.status),console.log(t.data),e.$store.commit("setTeamData",t.data)}).catch(function(t){t.response&&(e.error_message=t.message)})},check_delete_account:function(){var e={message:"Вы уверены, что хотите удалить аккаунт?",placeholder:"",input_field:!1,show:!0,callback:this.delete_account,args:null};this.$store.commit("setPopupOptions",e)},check_leave_team:function(){var e={message:"Вы уверены, что хотите покинуть команду?",placeholder:"",input_field:!1,show:!0,callback:this.leave_team,args:null};this.$store.commit("setPopupOptions",e)},leave_team:function(){var e=this;j.a.delete("/team/leave").then(function(t){console.log(t.status),console.log(t.data),e.$store.commit("deleteTeamData"),e.$store.dispatch("updateUserData"),e.$store.commit("deleteTeamMembers")}).catch(function(t){console.log(t.response.status),401===t.response.status&&(e.error_message=t.message)})},show_error:function(e){this.error_message=e}}},W=V,B=Object(i["a"])(W,w,x,!1,null,null,null),R=B.exports,z=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[e.validation_message?s("div",[e._v(e._s(e.validation_message))]):e._e(),s("div",[s("base-input",{attrs:{type:"text",placeholder:"Логин"},model:{value:e.request_body.login,callback:function(t){e.$set(e.request_body,"login",t)},expression:"request_body.login"}})],1),s("div",[s("base-input",{attrs:{type:"password",placeholder:"Пароль"},model:{value:e.request_body.password,callback:function(t){e.$set(e.request_body,"password",t)},expression:"request_body.password"}})],1),s("base-button",{attrs:{title:"Войти"},on:{click:e.sign_in}})],1)},H=[],K={name:"SignIn",data:function(){return{request_body:{login:"",password:""},validation_message:""}},methods:{sign_in:function(){var e=this;L(this)&&j.a.post("/user/sign_in",this.request_body).then(function(t){console.log(t.data),e.$store.commit("setUserData",t.data),e.$router.push("/account")}).catch(function(t){t.response?(console.log(t.response.status),400===t.response.status?e.validation_message="Неверный логин/пароль":e.$route.push("/error")):console.log(t)})}}};function L(e){for(var t in e.request_body)if(""===e.request_body[t])return e.validation_message="Заполните все поля формы",!1;return/[а-я]/g.test(e.request_body.login)?(e.validation_message="Поля не должны содержать кириллицу",!1):(e.validation_message="",!0)}var X=K,F=Object(i["a"])(X,z,H,!1,null,"71044c16",null),G=F.exports,Q=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[e.validation_message?s("div",[e._v(e._s(e.validation_message))]):e._e(),s("div",[s("base-input",{attrs:{type:"text",placeholder:"Имя"},model:{value:e.request_body.first_name,callback:function(t){e.$set(e.request_body,"first_name",t)},expression:"request_body.first_name"}})],1),s("div",[s("base-input",{attrs:{type:"text",placeholder:"Фамилия"},model:{value:e.request_body.last_name,callback:function(t){e.$set(e.request_body,"last_name",t)},expression:"request_body.last_name"}})],1),s("div",[s("base-input",{attrs:{type:"text",placeholder:"Группа"},model:{value:e.request_body.group,callback:function(t){e.$set(e.request_body,"group",t)},expression:"request_body.group"}})],1),s("div",[s("base-input",{attrs:{type:"text",placeholder:"Логин"},model:{value:e.request_body.login,callback:function(t){e.$set(e.request_body,"login",t)},expression:"request_body.login"}})],1),s("div",[s("base-input",{attrs:{type:"text",placeholder:"vk.сom/id"},model:{value:e.request_body.vk_ref,callback:function(t){e.$set(e.request_body,"vk_ref",t)},expression:"request_body.vk_ref"}})],1),s("div",[s("base-input",{attrs:{type:"password",placeholder:"Пароль"},model:{value:e.request_body.password,callback:function(t){e.$set(e.request_body,"password",t)},expression:"request_body.password"}})],1),s("div",[s("base-input",{attrs:{type:"password",placeholder:"Подтверждение пароля"},model:{value:e.confirm_password,callback:function(t){e.confirm_password=t},expression:"confirm_password"}})],1),s("div",[s("base-button",{attrs:{title:"Зарегистрироваться"},on:{click:e.sign_up}})],1)])},Y=[],Z={name:"signUp",data:function(){return{request_body:{first_name:"",last_name:"",login:"",password:"",group:"",vk_ref:"vk.com/"},confirm_password:"",validation_message:""}},methods:{sign_up:function(){var e=this;ee(this)&&(this.validation_message="",j.a.post("/user/sign_up",this.request_body).then(function(t){console.log(t.data),console.log(t.status),e.$store.commit("setUserData",t.data),e.$router.push("/sign_in")}).catch(function(t){console.log(t),e.validation_message="Поля заполнены неверно, пожалуйста заполните их соответсвенно подсказкам(которых пока нет)"}))}}};function ee(e){for(var t in e.request_body)if(""===e.request_body[t])return e.validation_message="Заполните все поля формы",!1;if(/[0-9]/g.test(e.request_body.first_name)||/[0-9]/g.test(e.request_body.last_name))return e.validation_message="Имя или фамилия не должны содержать цифр",!1;var s=/^([а-яА-Я]{1,3})(\d{1,2})(-{1})(\d{2})([мМ]?)$/g;return s.test(e.request_body.group)?(e.validation_message="",/[а-я]/g.test(e.request_body.login)?(e.validation_message="Логин не должен содержать кириллицу",!1):e.request_body.password===e.confirm_password||(e.validation_message="Пароли не совпадают!",e.valid)):(e.validation_message="Неверно введена группа",!1)}var te=Z,se=Object(i["a"])(te,Q,Y,!1,null,"70ed8870",null),ae=se.exports,ne=function(){var e=this,t=e.$createElement;e._self._c;return e._m(0)},oe=[function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("h1",[e._v("Всё пошло по пизде")])])}],re={name:"ErrorPage"},ue=re,ie=Object(i["a"])(ue,ne,oe,!1,null,"00e27463",null),ce=ie.exports,le=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{attrs:{id:"create-team"}},[e.create_status?s("div",[s("p",[e._v("Команда успешно создана!")]),s("p",[e._v("Перейдите в личный кабинет, чтобы просмотерть сведения о команде.")])]):s("div",[s("base-error-message",{attrs:{message:e.error_message}}),s("h1",[e._v("Создание команды")]),s("base-input",{attrs:{type:"text",placeholder:"Название команды"},model:{value:e.team_name,callback:function(t){e.team_name=t},expression:"team_name"}}),s("base-button",{attrs:{title:"Создать"},on:{click:e.createTeam}})],1)])},me=[],pe={name:"CreateTeam",data:function(){return{team_name:"",create_status:!1,error_message:""}},methods:{createTeam:function(){""!==this.team_name?this.request():this.errorMessage="Поле не должно быть пустым"},request:function(){var e=this;j.a.post("/team/create",{team_name:this.team_name}).then(function(t){console.log(t.data),console.log(t.status),e.$store.commit("setTeamData",t.data),e.$store.dispatch("updateUserData"),console.log("State.user: "+e.$store.getters.getUserData),e.create_status=!0}).catch(function(t){t.response?401===t.response.status?e.$router.push("/auth"):e.error_message=t.message:e.$router.push("/error")})}}},de=pe,_e=Object(i["a"])(de,le,me,!1,null,"3db11922",null),fe=_e.exports,he=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("base-error-message",{attrs:{message:e.error_message}}),s("h1",[e._v("Поиск команды")]),s("div",[s("base-input",{attrs:{type:"text",placeholder:"Название команды"},model:{value:e.team_name,callback:function(t){e.team_name=t},expression:"team_name"}})],1),s("h1",[e._v("Название команды")]),s("select",{directives:[{name:"model",rawName:"v-model",value:e.request_body.team_id,expression:"request_body.team_id"}],attrs:{size:"5"},on:{change:function(t){var s=Array.prototype.filter.call(t.target.options,function(e){return e.selected}).map(function(e){var t="_value"in e?e._value:e.value;return t});e.$set(e.request_body,"team_id",t.target.multiple?s:s[0])}}},e._l(e.search_team,function(t){return s("option",{domProps:{value:t.team_id}},[e._v(e._s(t.team_name))])}),0),s("base-button",{attrs:{title:"Вступить в команду"},on:{click:e.show_popup}})],1)},ve=[],be=(s("6762"),s("2fdb"),{name:"Join",data:function(){return{request_body:{team_id:0,invite_code:""},team_name:"",popup_message:"Введите пригласительный код",error_message:"",teams:[]}},mounted:function(){this.request_teams()},computed:{search_team:function(){var e=this;return this.teams.filter(function(t){return t.team_name.includes(e.team_name)})}},methods:{show_popup:function(){var e={message:"Введите пригласительный код",placeholder:"Пригласительный код",input_field:!0,show:!0,callback:this.join_team,args:this.request_body};this.$store.commit("setPopupOptions",e)},request_teams:function(){var e=this;j.a.get("/team/all").then(function(t){console.log(t.data),e.teams=t.data}).catch(function(t){t.response&&(console.log(t.response.status),console.log(t.message),401===t.response.status?e.$route.push("/auth"):403===t.response.status?e.$emit("error",t.message):(t.response.status,e.$emit("error",t.message)))})},join_team:function(e,t){var s=this;console.log(t),e.invite_code=t,j.a.post("/team/join",e).then(function(e){console.log(e.data),s.$store.commit("setTeamData",e.data),s.$store.dispatch("updateUserData"),s.$router.push("/account")}).catch(function(e){e.response&&(console.log(e.response.status),401===e.response.status?s.$router.push("/auth"):400===e.response.status?s.error_message=e.message:s.$emit("error",e.message))})}}}),ge=be,ye=Object(i["a"])(ge,he,ve,!1,null,"8074c332",null),$e=ye.exports;a["a"].use(m["a"]);var ke=new m["a"]({mode:"history",base:"/",routes:[{path:"/",name:"home",component:v},{path:"/account",name:"account",component:R},{path:"/auth",name:"auth",component:q},{path:"/sign_in",name:"sign_in",component:G},{path:"/sign_up",name:"sign_up",component:ae},{path:"/team/create",name:"team_create",component:fe},{path:"/team/add_member",name:"add_member",component:fe},{path:"/error",name:"error",component:ce},{path:"/join",name:"join",component:$e}]}),qe=ke,we=s("2f62");a["a"].use(we["a"]);var xe={message:"",placeholder:"",input_field:!1,show:!1,callback:null,args:null},Oe=new we["a"].Store({state:{user:null,team:null,team_members:null,popup:xe},mutations:{setUserData:function(e,t){e.user=t},setTeamData:function(e,t){e.team=t},setTeamMembers:function(e,t){e.team_members=t},setPopupOptions:function(e,t){e.popup=t},setPopupInputValue:function(e,t){e.popup.value=t},deleteTeamMembers:function(e){e.team_members=null},deleteTeamData:function(e){e.team=null},deleteUserData:function(e){e.user=null},deletePopupOptions:function(e){e.popup=xe}},getters:{getUserData:function(e){return e.user},getTeamData:function(e){return e.team}},actions:{updateUserData:function(e){j.a.get("/user/info").then(function(t){console.log(t),e.commit("setUserData",t.data)}).catch(function(e){console.log("NOT RESPONSE: "+e),console.log(e.response.status),console.log(e.response.data)})}}}),je=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("button",{on:{click:function(t){return e.$emit("click")}}},[e._v(e._s(e.title))])])},Te=[],De={name:"baseButton",props:{title:String}},Pe=De,Ee=(s("ce43"),Object(i["a"])(Pe,je,Te,!1,null,"509372b3",null)),Ue=Ee.exports,Me=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("input",e._b({attrs:{type:e.type,placeholder:e.placeholder},on:{input:function(t){return e.$emit("input",t.target.value)}}},"input",e.$attrs,!1))])},Se=[],Ce={name:"BaseInput",inheritAttrs:!1,props:{type:String,placeholder:String}},Ae=Ce,Ie=Object(i["a"])(Ae,Me,Se,!1,null,"590d7b4d",null),Ne=Ie.exports,Je=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{attrs:{id:"error-message"},on:{error:e.showMessage}},[s("p",[e._v(e._s(e.message))])])},Ve=[],We={name:"ErrorMessage",props:{message:String},methods:{showMessage:function(e){this.message=e}}},Be=We,Re=Object(i["a"])(Be,Je,Ve,!1,null,"26aeca7e",null),ze=Re.exports,He=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"popup-container"},[s("transition",{attrs:{name:"fade"}},[e.popup.show?s("div",{staticClass:"base-popup"},[s("h1",[e._v("Подтверждение")]),s("div",{staticClass:"popup-message"},[e._v("\n                "+e._s(e.popup.message)+"\n            ")]),e.popup.input_field?s("base-input",{attrs:{type:"text"},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}}):e._e(),s("base-button",{attrs:{title:"ОК"},on:{click:e.handleAccess}}),s("base-button",{attrs:{title:"Отмена"},on:{click:function(t){e.popup.show=!1}}})],1):e._e()])],1)},Ke=[],Le={name:"base-popup",data:function(){return{value:""}},computed:{popup:function(){return this.$store.state.popup}},methods:{handleAccess:function(){""!==this.value?this.popup.callback(this.popup.args,this.value):this.popup.callback(this.popup.args),this.$store.commit("deletePopupOptions")}}},Xe=Le,Fe=(s("a620"),Object(i["a"])(Xe,He,Ke,!1,null,"63908b14",null)),Ge=Fe.exports;j.a.defaults.baseURL="http://5.23.54.233:5050",j.a.defaults.withCredentials=!0,a["a"].component("base-button",Ue),a["a"].component("base-input",Ne),a["a"].component("base-error-message",ze),a["a"].component("base-popup",Ge),a["a"].config.productionTip=!1,new a["a"]({router:qe,store:Oe,render:function(e){return e(l)}}).$mount("#app")},"5c0b":function(e,t,s){"use strict";var a=s("e332"),n=s.n(a);n.a},"9a37":function(e,t,s){},a466:function(e,t,s){},a620:function(e,t,s){"use strict";var a=s("c717"),n=s.n(a);n.a},c717:function(e,t,s){},ce43:function(e,t,s){"use strict";var a=s("a466"),n=s.n(a);n.a},cf05:function(e,t,s){e.exports=s.p+"img/logo.82b9c7a5.png"},e332:function(e,t,s){},f5c5:function(e,t,s){"use strict";var a=s("3202"),n=s.n(a);n.a},fccb:function(e,t,s){"use strict";var a=s("9a37"),n=s.n(a);n.a}});
//# sourceMappingURL=app.bef9e1fb.js.map